name: Assemble Release AAB
on:
  workflow_call:
    inputs:
      version:
        required: true
        type: string
    outputs:
      artifactName: ${{ jobs.build.outputs.artifactName }}

jobs:
  build:
    outputs:
      version: ${{ steps.build.outputs.artifactName }}
    uses: ./.github/workflows/build_sign.yml
    with:
      assembleScript: .github/scripts/assemble_release_aab.sh
      outputDir:      app/build/outputs/bundle/release
      unsignedName:   app-release.aab
      artifactName:   spacex-release_${{ inputs.version }}.aab
    secrets:
      signingKey:       ${{ secrets.SIGNING_KEY }}
      alias:            ${{ secrets.ALIAS }}
      keyStorePassword: ${{ secrets.KEY_STORE_PASSWORD }}
      keyPassword:      ${{ secrets.KEY_PASSWORD }}
  outputs:
    artifactName: ${{ jobs.build.outputs.artifactName }}
