name: Nightly Release Internal

on:
  schedule:
    - cron: "0 2 * * 1-4"  # Every Mon‚ÄìThu at 02:00 UTC (03:00 UK/BST)

  workflow_dispatch:

jobs:

  # ------------------------------------------
  # üîñ Checks for Commits & Tags Release
  # ------------------------------------------
  tag-release:
    uses: ./.github/workflows/tag_release.yml

  # ------------------------------------------
  # üß© Versioning - Bump Version Code & Name
  # ------------------------------------------
  version-bump:
    needs: [tag-release]
    uses: ./.github/workflows/version_bump_old.yml
    secrets: inherit

  # ------------------------------------------
  # ‚è≥ Wait for version bump PR to be merged
  # ------------------------------------------
  poll-version-bump-pr-merge:
    needs: [version-bump]
    uses: ./.github/workflows/poll_version_bump_pr_merge.yml
    secrets: inherit

  # ----------------------------------------------
  # üöÄ Tags the Release & Generates Release Notes
  # ----------------------------------------------
  github-release:
    needs: [tag-release, poll-version-bump-pr-merge]
    uses: ./.github/workflows/github_release.yml
    with:
      release_tag: ${{ needs.tag-release.outputs.RELEASE_TAG }}
    secrets: inherit
